{% extends "todo/base.html" %}

{% block content %}
<h2>{{ user.username }}'s Todo List</h2>

<p><a href="{% url 'todo:add_todo' %}" class="button">+ Add New Todo</a></p>

{% if todos %}
<table>
    <thead>
    <tr>
        <th>Title</th>
        <th>Description</th>
        <th>Status</th>
        <th>Created At</th>
    </tr>
    </thead>
    <tbody>
    {% for todo in todos %}
    <tr>
        <td>{{ todo.title }}</td>
        <td>{{ todo.description }}</td>
        <td>
            <form method="post" style="display: flex; gap: 8px; align-items: center;">
                {% csrf_token %}
                <input type="hidden" name="todo_id" value="{{ todo.id }}">
                <select name="status" class="auto-submit">
                    {% for value, label in status_choices %}
                    <option value="{{ value }}" {% if value == todo.status %}selected{% endif %}>{{ label }}</option>
                    {% endfor %}
                </select>
            </form>
        </td>
        <td>{{ todo.created_at|date:"M d, Y H:i" }}</td>
    </tr>
    {% endfor %}
    </tbody>
</table>
{% else %}
<p>No tasks yet. Click "Add New Todo" to create one!</p>
{% endif %}
{% endblock %}
